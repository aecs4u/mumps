# MUMPS Benchmark Results Web Interface

FastAPI-based web interface for viewing MUMPS and BLAS benchmark results.

## Features

- üìä **Interactive dashboard** for benchmark results
- üóÑÔ∏è **SQLite database** with TSV fallback
- üî¢ **Multi-precision support** (s/d/c/z)
- üìà **Ordering library comparison** (PORD, METIS, SCOTCH, AMD, etc.)
- üåê **JSON API** for programmatic access
- ‚ö° **Fast filtering** by precision and ordering method

## Quick Start

### Using Makefile (simplest)

```bash
# Start webapp (port 9001)
make webapp

# View in browser
make webapp-open
# Or manually: xdg-open http://localhost:9001

# Check status
make webapp-health
# Or manually: curl http://localhost:9001/health

# Stop webapp
make webapp-stop
# Or manually: pkill -f "uvicorn main:app"
```

### Using the startup script

```bash
# Start with default port (9001)
./scripts/start_webapp.sh

# Custom port
./scripts/start_webapp.sh --port 8080

# Enable auto-reload for development
./scripts/start_webapp.sh --reload

# Custom host and port
./scripts/start_webapp.sh --host 0.0.0.0 --port 9001
```

### Using Python directly

```bash
# From project root
python3 -m webapp.main

# With arguments
python3 -m webapp.main --port 8080 --reload
```

### Using uvicorn directly

```bash
# Default (uses port 9001 from code)
uvicorn webapp.main:app

# Custom port
uvicorn webapp.main:app --port 9001

# Development mode with auto-reload
uvicorn webapp.main:app --port 9001 --reload

# Expose to network
uvicorn webapp.main:app --host 0.0.0.0 --port 9001
```

## Configuration

### Port Configuration

**Default port**: 9001

Configure via (in order of precedence):
1. **Command-line argument**: `--port 9001`
2. **Environment variable**: `WEBAPP_PORT=9001`
3. **Default**: 9001

### Host Configuration

**Default host**: 127.0.0.1 (localhost only)

Configure via:
1. **Command-line argument**: `--host 0.0.0.0`
2. **Environment variable**: `WEBAPP_HOST=0.0.0.0`
3. **Default**: 127.0.0.1

### Data Paths

**Environment variables**:
- `BLAS_BENCH_RESULTS_DIR`: Results directory (default: `benchmarks/results`)
- `MUMPS_BENCH_DB`: SQLite database path (default: `benchmarks/mumps_benchmarks.sqlite`)
  - Legacy: `BLAS_BENCH_DB` still supported for backward compatibility

## API Endpoints

### Web Interface

- **`GET /`** - Main dashboard with interactive results
  - Query parameters:
    - `precision` - Arithmetic precision: s, d, c, or z (default: d)
    - `ordering` - Ordering method: AMD, AMF, SCOTCH, PORD, METIS, QAMD, Auto (default: Auto)
  - Example: `http://localhost:9001/?precision=d&ordering=METIS`

### JSON API

- **`GET /api/results`** - All benchmark results as JSON
  - Returns: `{sparse: {...}, dense: {...}, results_dir: "...", db_path: "..."}`

- **`GET /health`** - Health check endpoint
  - Returns: `{status: "healthy", database: {...}, results_dir: {...}}`
  - Use for monitoring and verifying webapp is running

## Data Sources

The webapp automatically detects and uses the best available data source:

1. **SQLite database** (preferred): `benchmarks/mumps_benchmarks.sqlite`
   - Generated by `scripts/ingest_benchmark_results_sqlite.py`
   - Supports multi-precision and multi-ordering benchmarks
   - Efficient querying and filtering

2. **TSV files** (fallback): `benchmarks/results/*.tsv`
   - Legacy format for backward compatibility
   - Sparse: `sparse_blas_{precision}_{ordering}_latest.tsv`
   - Dense: `dense_blas_scores_{precision}_latest.tsv`, `dense_blas_cases_{precision}_latest.tsv`

## Requirements

```bash
pip install fastapi uvicorn jinja2
```

## See Also

- **[INCREMENTAL_BUILD_GUIDE.md](../docs/INCREMENTAL_BUILD_GUIDE.md)** - Benchmark performance optimization
- **[QUICKSTART.md](../docs/QUICKSTART.md)** - Quick start guide
- `scripts/benchmark_blas.sh` - Sparse benchmark script
- `scripts/run_all_benchmarks_to_sqlite.sh` - Full benchmark pipeline
