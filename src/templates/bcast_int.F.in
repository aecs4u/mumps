!
!  This file is part of MUMPS 5.8.2, released
!  on Mon Jan 12 15:17:08 UTC 2026
!
!
!  Copyright 1991-2026 CERFACS, CNRS, ENS Lyon, INP Toulouse, Inria,
!  Mumps Technologies, University of Bordeaux.
!
!  This version of MUMPS is provided to you free of charge. It is
!  released under the CeCILL-C license 
!  (see doc/CeCILL-C_V1-en.txt, doc/CeCILL-C_V1-fr.txt, and
!  https://cecill.info/licences/Licence_CeCILL-C_V1-en.html)
!
SUBROUTINE @MUMPS_PREFIX@MUMPS_MCAST2(DATA, LDATA, MPITYPE, ROOT, &
  &SLAVEF, KEEP)
USE MUMPS_BUF_COMMON, ONLY : MUMPS_BUF_SEND_1INT
IMPLICIT NONE
INCLUDE 'mpif.h'
INTEGER IERR
INTEGER LDATA, ROOT, COMMW, TAG, MPITYPE, SLAVEF
INTEGER DEST
INTEGER, INTENT(INOUT) :: KEEP(500)
INTEGER DATA(LDATA)
DO DEST = 0, SLAVEF - 1
  IF (DEST .NE. ROOT) THEN
    IF ( LDATA .EQ. 1 .and. MPITYPE .EQ. MPI_INTEGER ) THEN
      CALL MUMPS_BUF_SEND_1INT( DATA(1), DEST, TAG, &
  &                                COMMW, KEEP, IERR )
    ELSE
      WRITE(*,*) 'Error : bad argument to @MUMPS_PREFIX@MUMPS_MCAS
      CALL MUMPS_ABORT()
    END IF
  ENDIF
END DO
RETURN
END SUBROUTINE @MUMPS_PREFIX@MUMPS_MCAST2
SUBROUTINE @MUMPS_PREFIX@MUMPS_BDC_ERROR( MYID, SLAVEF, COMM, KEEP
INTEGER MYID, SLAVEF, COMM
INTEGER, INTENT(INOUT) :: KEEP(500)
INCLUDE 'mpif.h'
INCLUDE 'mumps_tags.h'
INTEGER DUMMY (1)
DUMMY(1) = -98765
CALL @MUMPS_PREFIX@MUMPS_MCAST2( DUMMY, 1, MPI_INTEGER, MYID, &
  &                 COMM, TERREUR, SLAVEF, KEEP )
RETURN
END SUBROUTINE @MUMPS_PREFIX@MUMPS_BDC_ERROR
